#!/usr/bin/env python
from __future__ import print_function
from minard.data import data_producer
import socket
import time

if __name__ == '__main__':
    import argparse

    parser = argparse.ArgumentParser('data stream producer')
    parser.add_argument('--host',default='daq1.sp.snolab.ca')
    parser.add_argument('--port',default=4000,type=int)
    args = parser.parse_args()

    while True:
	try:
	    data_producer(args.host,args.port)
	except socket.error as e:
	    print('failed to connect to data: %s' % str(e))
	    time.sleep(60)
